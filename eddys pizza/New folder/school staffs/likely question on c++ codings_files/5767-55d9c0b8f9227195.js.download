"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5767],{49544:function(e,t){t.DF={prefix:"far",iconName:"eye",icon:[576,512,[128065],"f06e","M288 80c-65.2 0-118.8 29.6-159.9 67.7C89.6 183.5 63 226 49.4 256c13.6 30 40.2 72.5 78.6 108.3C169.2 402.4 222.8 432 288 432s118.8-29.6 159.9-67.7C486.4 328.5 513 286 526.6 256c-13.6-30-40.2-72.5-78.6-108.3C406.8 109.6 353.2 80 288 80zM95.4 112.6C142.5 68.8 207.2 32 288 32s145.5 36.8 192.6 80.6c46.8 43.5 78.1 95.4 93 131.1c3.3 7.9 3.3 16.7 0 24.6c-14.9 35.7-46.2 87.7-93 131.1C433.5 443.2 368.8 480 288 480s-145.5-36.8-192.6-80.6C48.6 356 17.3 304 2.5 268.3c-3.3-7.9-3.3-16.7 0-24.6C17.3 208 48.6 156 95.4 112.6zM288 336c44.2 0 80-35.8 80-80s-35.8-80-80-80c-.7 0-1.3 0-2 0c1.3 5.1 2 10.5 2 16c0 35.3-28.7 64-64 64c-5.5 0-10.9-.7-16-2c0 .7 0 1.3 0 2c0 44.2 35.8 80 80 80zm0-208a128 128 0 1 1 0 256 128 128 0 1 1 0-256z"]},t.Md=t.DF},33326:function(e,t){t.DF={prefix:"far",iconName:"trash",icon:[448,512,[],"f1f8","M177.1 48h93.7c2.7 0 5.2 1.3 6.7 3.6l19 28.4h-145l19-28.4c1.5-2.2 4-3.6 6.7-3.6zM354.2 80L317.5 24.9C307.1 9.4 289.6 0 270.9 0H177.1c-18.7 0-36.2 9.4-46.6 24.9L93.8 80H80.1 32 24C10.7 80 0 90.7 0 104s10.7 24 24 24H35.6L59.6 452.7c2.5 33.4 30.3 59.3 63.8 59.3H324.6c33.5 0 61.3-25.9 63.8-59.3L412.4 128H424c13.3 0 24-10.7 24-24s-10.7-24-24-24h-8H367.9 354.2zm10.1 48L340.5 449.2c-.6 8.4-7.6 14.8-16 14.8H123.4c-8.4 0-15.3-6.5-16-14.8L83.7 128H364.3z"]},t.$=t.DF},36550:function(e,t,l){var n=l(97458),i=l(97381);l(52983);var s=l(99513),o=l(23647),r=l(63820);let c=e=>{let{textVariant:t="baseSemi",textColor:l="default",assistant:c}=e,{AssistantConfigs:a,Assistant:d}=(0,s.I)();return c&&c!=d.internet&&null!=a[c]?(0,n.jsx)(o.ZP,{children:(0,n.jsxs)(r.Z,{variant:t,color:l,className:"flex items-center gap-x-xs",children:[(0,n.jsx)(i.G,{size:"1x",icon:a[c].icon}),(0,n.jsx)("div",{children:a[c].text})]})}):null};t.Z=c},22660:function(e,t,l){var n=l(97458),i=l(52983),s=l(95914),o=l(51582),r=l(10785),c=l(80937),a=l(4028),d=l(33326),u=l(61904),h=l(94835),m=l(78476),x=l(43339),f=l(66187),v=l(27586);let p=e=>{let{show:t,onDelete:l,onAddToCollection:p,onSwapCollection:I,onRemoveFromCollection:N,currentCollection:g,rwToken:j,type:C}=e,{isMobileStyle:E}=(0,h.d)(),R=C===o.W.LIBRARY&&null==g&&null!=p,y=null!=g&&null!=I&&null!=j,w=null!=N&&null!=g&&((0,m.mF)(g.user_permission)||null!=j),T=null!=l&&null!=j,[b,A]=(0,i.useState)(!1),D=(0,s.useTranslations)("threadItem"),M=(0,s.useTranslations)("shared");if(!t||!R&&!y&&!w&&!T)return null;let Z=[{icon:c.r8,text:D("addToCollection"),show:R,onClick:p,testId:"thread-add-to-collection"},{icon:a.a_,text:D("swapCollections"),show:y,onClick:I,testId:"thread-swap-collection"},{icon:u.faXmark,text:D("removeFromCollection"),show:w,onClick:N,testId:"thread-remove-from-collection"},{icon:d.$,text:D("deleteThread"),show:T,onClick:()=>A(!0),testId:"thread-delete"}];return(0,n.jsxs)("div",{className:"-mr-xs",children:[(0,n.jsx)(x.G,{items:Z,isMobileStyle:E,children:(0,n.jsx)(f.Z,{isMobileStyle:E,testId:"thread-dropdown-menu",size:"small",icon:r.faEllipsis})}),(0,n.jsx)(v.Z,{isMobileStyle:E,isOpen:b,onClose:()=>A(!1),message:D("deleteThreadConfirmation"),actionList:[{text:M("nevermind"),onClick:()=>A(!1)},{text:M("confirm"),variant:"rejected",onClick:l}]})]})};t.Z=p},51582:function(e,t,l){l.d(t,{W:function(){return i},B:function(){return H}});var n,i,s=l(97458),o=l(52983),r=l(95914),c=l(25967),a=l.n(c),d=l(44584),u=l(54911);let h=e=>{let{collections:t}=(0,u.l)();if(!e)return null;let l=null==t?void 0:t.find(t=>t.uuid===e);return null!=l?l:null};var m=l(34461),x=l(19114),f=l(78309),v=l(67883),p=l(14393),I=l(76071),N=l(22660),g=l(54877),j=l.n(g);let C=o.memo(e=>{let{type:t,featuredImage:l,title:n,href:o}=e;return l&&t===i.DISCOVER?(0,s.jsx)(a(),{href:o,children:(0,s.jsx)("div",{className:"relative h-24 w-24 flex-none overflow-hidden rounded-md",children:(0,s.jsx)(j(),{src:l,alt:n,sizes:"33vw",fill:!0,priority:!0,style:{objectFit:"cover"}})})}):null});var E=l(36550),R=l(97381),y=l(63820),w=l(8429);let T=o.memo(e=>(0,s.jsxs)("div",{className:"flex items-center  gap-x-xs",children:[(0,s.jsx)(y.Z,{variant:"tiny",color:"light",children:(0,s.jsx)(R.G,{size:"sm",icon:e.icon})}),(0,s.jsx)(y.Z,{variant:"tiny",color:"light",children:(0,w.uf)(e.count)})]}),(e,t)=>e.count===t.count&&e.icon===t.icon);var b=l(51253),A=l(49544),D=l(33131);let M=o.memo(e=>{var t,l;let{threadAccess:n,socialInfo:i}=e;if(!n||!i||n<D.uv.PUBLIC_READ)return null;let o=null!==(t=i.view_count)&&void 0!==t?t:0,r=null!==(l=i.fork_count)&&void 0!==l?l:0;return i.like_count,(0,s.jsxs)(s.Fragment,{children:[o>0&&(0,s.jsx)(T,{icon:A.Md,count:o}),r>0&&(0,s.jsx)(T,{icon:b.MD,count:r})]})});var Z=l(34957),k=l(40531);let _=o.memo(e=>{let{threadCount:t,threadAccess:l,lastUpdated:n,socialInfo:i,assistant:o,isMobileStyle:r}=e;return(0,s.jsxs)("div",{className:"flex items-center gap-x-md",children:[!!t&&t>1&&(0,s.jsx)(T,{icon:Z.Oq,count:t}),(0,s.jsx)(M,{socialInfo:i,threadAccess:l}),(0,s.jsx)(k.Z,{timestamp:n,isMobileStyle:r}),(0,s.jsx)(E.Z,{textColor:"light",textVariant:"tiny",assistant:o})]})});var P=l(80937),O=l(94835),L=l(23647),S=l(66187);let z=e=>{let{title:t,preview:l,threadCount:n,lastUpdated:c,href:g="/",rwToken:j,assistant:E,socialInfo:R,showActionMenu:w=!0,authorImage:T,threadAccess:b,type:A,featuredImage:D,entryUUID:M,collection:Z}=e,k=h(null==Z?void 0:Z.uuid),{openModal:z}=(0,f.X)(),{collections:V}=(0,u.l)(),{searchTerm:F}=(0,v.p)(),{removeThreadFromCollection:W,deleteThread:U}=(0,m.l)(),H=(0,d.useRouter)(),{isMobileStyle:B}=(0,O.d)(),{trackEvent:G}=(0,x.WS)(),X=(0,r.useTranslations)("threadItem"),q=(0,o.useCallback)(e=>{let{entryUUID:t}=e;0===V.length?z("collectionCreateOrEdit",{existingCollection:k,searchTerm:F}):z("collectionSelectModal",{entryUUID:t,userCollections:V,currentCollection:k,searchTerm:F})},[k,V,z,F]),Y=(0,o.useCallback)(async e=>{U({entryUUID:e,collectionSlug:null==k?void 0:k.slug}),G("delete thread from history click",{entryUUID:e})},[null==k?void 0:k.slug,U,G]);return(0,s.jsxs)(L.ZP,{className:"flex items-center gap-x-md py-md md:px-0",children:[(0,s.jsx)(C,{featuredImage:D,type:A,title:t,href:g}),(0,s.jsxs)("div",{className:"grow",children:[(0,s.jsx)(a(),{href:g,className:"group block",children:(0,s.jsxs)(L.ZP,{className:"",children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-md",children:[(0,s.jsx)(y.Z,{className:"grow",variant:"baseSemi",children:(0,s.jsx)("div",{"data-testid":"thread-title",className:"break-all transition duration-300 line-clamp-1 md:group-hover:text-super md:dark:group-hover:text-superDark",children:t})}),null!=T&&(0,s.jsx)(I.Z,{size:"small",user:T,isMobileStyle:B})]}),(0,s.jsx)(y.Z,{color:"light",className:"break-word text-balance mt-two line-clamp-2",children:l})]})}),(0,s.jsx)("div",{className:w?"mt-xs":"mt-sm",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(_,{threadCount:n,threadAccess:b,lastUpdated:c,socialInfo:R,assistant:E,isMobileStyle:B}),(0,s.jsxs)("div",{className:"flex items-center gap-x-xs",children:[(null==Z?void 0:Z.title)&&A===i.LIBRARY&&(0,s.jsx)(a(),{href:"/collections/".concat(null==Z?void 0:Z.slug),className:"block",children:(0,s.jsx)(L.ZP,{className:"rounded-full border px-xs",children:(0,s.jsxs)(y.Z,{variant:"tiny",className:"flex cursor-pointer select-none items-center gap-x-xs px-sm py-xs transition duration-300 hover:opacity-70",testId:"thread-collection-pill",children:[(0,s.jsx)(p.B,{unified:Z.emoji,size:"tiny"}),(0,s.jsx)("div",{className:"line-clamp-1",children:Z.title})]})})}),w&&!(null==Z?void 0:Z.title)&&(0,s.jsx)(S.Z,{isMobileStyle:B,testId:"add-to-collection",toolTip:X("addToCollection"),onClick:()=>q({entryUUID:M}),icon:P.r8,size:"small"}),(0,s.jsx)(N.Z,{show:w,onDelete:()=>Y(M),onAddToCollection:()=>q({entryUUID:M}),onSwapCollection:()=>q({entryUUID:M}),onRemoveFromCollection:()=>W({entryUUID:M,oldCollectionUUID:k.uuid,callback:()=>{A===i.COLLECTION&&H.push("/library")}}),currentCollection:k,rwToken:j,type:A})]})]})})]})]})},V=(e,t,l)=>{(0,o.useEffect)(()=>{let n=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&t()})},l),i=e.current;return i&&n.observe(i),()=>{i&&n.unobserve(i)}},[e,t,l])};var F=l(84724),W=l(86813),U=l(39378);(n=i||(i={})).LIBRARY="library",n.COLLECTION="collection",n.DISCOVER="discover";let H=e=>{var t;let{threads:l,fetchNextPage:n,hasNextPage:r=!1,showLoadingState:c=!1,showEmptyState:a=!1,type:d}=e,u=(null!=l?l:[]).map(F.gN),h=(0,o.useRef)(l);(0,o.useEffect)(()=>{h.current=l},[l]);let m=(0,o.useRef)(n);m.current=n;let x=(0,o.useRef)((0,U.debounce)(()=>m.current(),300)),f=(0,o.useRef)(null);return V(f,x.current,{rootMargin:"50px",threshold:0}),(0,s.jsxs)(s.Fragment,{children:[a&&0===u.length&&(0,s.jsx)(L.ZP,{variant:"offset",className:"mt-md flex items-center justify-center rounded p-xl",children:d===i.COLLECTION?(0,s.jsx)(y.Z,{color:"light",children:"Threads in this collection will show up here"}):(0,s.jsx)(y.Z,{color:"light",children:"No threads yet"})}),(0,s.jsx)(L.ZP,{className:"divide-y",children:u.map(e=>(0,s.jsx)(z,{href:e.href,rwToken:e.rwToken,title:e.title,preview:e.preview,threadCount:e.threadCount,lastUpdated:e.lastUpdated,copilot:e.copilot,assistant:e.assistant,socialInfo:e.socialInfo,threadAccess:e.threadAccess,authorImage:e.authorImage,featuredImage:null!==(t=e.featuredImage)&&void 0!==t?t:null,showActionMenu:d!==i.DISCOVER,type:d,entryUUID:e.entryUUID,collection:e.collection},e.entryUUID))}),c&&(0==u.length?(0,s.jsx)(L.ZP,{className:"py-sm",children:(0,s.jsx)(W.Z,{animateLines:!1,blockCount:12,divider:!0})}):(0,s.jsx)(L.ZP,{className:"py-md",children:(0,s.jsx)(W.Z,{animateLines:!1,blockCount:1})})),u.length>0&&r&&(0,s.jsx)("div",{ref:f,className:"border border-transparent"})]})}},54911:function(e,t,l){l.d(t,{l:function(){return o}});var n=l(83427),i=l(20618),s=l(7026);let o=()=>{var e;let t=(0,i.nO)(),l=async e=>{let{pageParam:l}=e;(!l||l<1)&&(l=1);let n=(l-1)*20,i=await t.emitWithAck("list_user_collections",{limit:20,offset:n});return i},{data:o}=(0,n.N)({enabled:!!t,queryKey:s.Xt,queryFn:e=>{let{pageParam:t=1}=e;return l({pageParam:t})},getNextPageParam:(e,t)=>{var l;let n=e&&(null===(l=e[0])||void 0===l?void 0:l.has_next_page);return n?t.length+1:void 0}});return{collections:null!==(e=null==o?void 0:o.pages[o.pages.length-1])&&void 0!==e?e:[]}}},27586:function(e,t,l){var n=l(97458);l(52983);var i=l(63820),s=l(64696);let o=e=>{let{message:t,...l}=e;return(0,n.jsx)(s.Z,{title:void 0,subtitle:void 0,...l,children:(0,n.jsx)(i.Z,{variant:"section-title",className:"pb-md text-center",children:t})})};t.Z=o},40531:function(e,t,l){var n=l(97458),i=l(53415),s=l(97381),o=l(51987);l(52983);var r=l(63820),c=l(66187),a=l(35254);let d=e=>{let{isMobileStyle:t,timestamp:l,isRecentHidden:d=!1,layoutType:u="right"}=e,h=(0,a.f)();if(!l||!h)return null;let m=o.ou.fromISO("".concat(l,"Z")),x=(e=>{var t,l,n,i,s,r;let c=o.ou.local(),a=c.diff(e,["years","months","days","hours","minutes","seconds"]).toObject(),u=null!==(t=a.years)&&void 0!==t?t:0,h=null!==(l=a.months)&&void 0!==l?l:0,m=null!==(n=a.days)&&void 0!==n?n:0,x=null!==(i=a.hours)&&void 0!==i?i:0,f=null!==(s=a.minutes)&&void 0!==s?s:0;return u>=1?"".concat(Math.round(u),"y ago"):h>=1?"".concat(Math.round(h),"mo ago"):m>=1?"".concat(Math.round(m),"d ago"):x>=1?"".concat(Math.round(x),"h ago"):f>=1?"".concat(Math.round(f),"m ago"):d?null:"".concat(Math.round(null!==(r=a.seconds)&&void 0!==r?r:0),"s ago")})(m),f=m.toLocaleString(o.ou.DATETIME_FULL);return null!==x&&(0,n.jsxs)("div",{className:"flex gap-x-xs items-center",children:[(0,n.jsx)(r.Z,{variant:"tiny",color:"light",children:(0,n.jsx)(s.G,{size:"sm",icon:i.SZ})}),(0,n.jsx)(c.Z,{isMobileStyle:t,variant:"noHover",size:"tiny",toolTip:f,tooltipLayout:u,text:x,extraCSS:"pl-0 pr-0"})]})};t.Z=d},78476:function(e,t,l){var n,i,s,o;function r(e){return e===n.OWNER}function c(e){return e>=n.WRITER&&e<n.INVITED_READER}function a(e){return[n.INVITED_READER,n.INVITED_WRITER,n.INVITED_ADMIN].includes(e)}function d(e){let t=e.owner_user,l=e.contributor_users,i=[],s=[];return null==l||l.forEach(e=>{e.permission===n.INVITED_READER||e.permission===n.INVITED_WRITER||e.permission===n.INVITED_ADMIN?i.push(e):s.push(e)}),{ownerUser:t,contributorUsers:s,invitedUsers:i}}l.d(t,{XJ:function(){return n},gO:function(){return d},hf:function(){return c},mF:function(){return r},rj:function(){return a},rm:function(){return u}}),(s=n||(n={}))[s.NONE=0]="NONE",s[s.READER=1]="READER",s[s.WRITER=2]="WRITER",s[s.ADMIN=3]="ADMIN",s[s.OWNER=4]="OWNER",s[s.INVITED_READER=11]="INVITED_READER",s[s.INVITED_WRITER=12]="INVITED_WRITER",s[s.INVITED_ADMIN=13]="INVITED_ADMIN",(o=i||(i={})).ThreadAccessNotAllowed="ThreadAccessNotAllowed",o.InvalidThread="InvalidThread",o.ArticleAccessNotAllowed="ArticleAccessNotAllowed",o.CollectionAccessNotAllowed="CollectionAccessNotAllowed",o.InvalidCollection="InvalidCollection";let u={[i.ThreadAccessNotAllowed]:"Cannot view this thread",[i.InvalidThread]:"This thread does not exist.",[i.ArticleAccessNotAllowed]:"Cannot view this article",[i.CollectionAccessNotAllowed]:"Cannot view this collection",[i.InvalidCollection]:"This collection does not exist."}},83427:function(e,t,l){l.d(t,{N:function(){return c}});var n=l(20355),i=l(63675),s=l(73584);class o extends i.z{constructor(e,t){super(e,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e,t){super.setOptions({...e,behavior:(0,s.Gm)()},t)}getOptimisticResult(e){return e.behavior=(0,s.Gm)(),super.getOptimisticResult(e)}fetchNextPage({pageParam:e,...t}={}){return this.fetch({...t,meta:{fetchMore:{direction:"forward",pageParam:e}}})}fetchPreviousPage({pageParam:e,...t}={}){return this.fetch({...t,meta:{fetchMore:{direction:"backward",pageParam:e}}})}createResult(e,t){var l,n,i,o,r,c;let{state:a}=e,d=super.createResult(e,t),{isFetching:u,isRefetching:h}=d,m=u&&(null==(l=a.fetchMeta)?void 0:null==(n=l.fetchMore)?void 0:n.direction)==="forward",x=u&&(null==(i=a.fetchMeta)?void 0:null==(o=i.fetchMore)?void 0:o.direction)==="backward";return{...d,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:(0,s.Qy)(t,null==(r=a.data)?void 0:r.pages),hasPreviousPage:(0,s.ZF)(t,null==(c=a.data)?void 0:c.pages),isFetchingNextPage:m,isFetchingPreviousPage:x,isRefetching:h&&!m&&!x}}}var r=l(4167);function c(e,t,l){let i=(0,n._v)(e,t,l);return(0,r.r)(i,o)}}}]);