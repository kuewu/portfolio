"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9891],{57632:function(e,t){t.DF={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"]},t.ne=t.DF},91007:function(e,t){t.DF={prefix:"fab",iconName:"whatsapp",icon:[448,512,[],"f232","M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"]},t.VH=t.DF},85002:function(e,t){t.DF={prefix:"far",iconName:"arrow-down",icon:[384,512,[8595],"f063","M174.6 472.6c4.5 4.7 10.8 7.4 17.4 7.4s12.8-2.7 17.4-7.4l168-176c9.2-9.6 8.8-24.8-.8-33.9s-24.8-8.8-33.9 .8L216 396.1 216 56c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 340.1L41.4 263.4c-9.2-9.6-24.3-9.9-33.9-.8s-9.9 24.3-.8 33.9l168 176z"]},t.r5=t.DF},56269:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var l="circle-stop",n=[62094,"stop-circle"],i="f28d",o="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm192-96H320c17.7 0 32 14.3 32 32V320c0 17.7-14.3 32-32 32H192c-17.7 0-32-14.3-32-32V192c0-17.7 14.3-32 32-32z";t.definition={prefix:"far",iconName:l,icon:[512,512,n,i,o]},t.faCircleStop=t.definition,t.prefix="far",t.iconName=l,t.width=512,t.height=512,t.ligatures=n,t.unicode=i,t.svgPathData=o,t.aliases=n},44835:function(e,t){t.DF={prefix:"far",iconName:"clipboard-check",icon:[384,512,[],"f46c","M320 64H280h-9.6C263 27.5 230.7 0 192 0s-71 27.5-78.4 64H104 64C28.7 64 0 92.7 0 128V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V128c0-35.3-28.7-64-64-64zM80 112v24c0 13.3 10.7 24 24 24h88 88c13.3 0 24-10.7 24-24V112h16c8.8 0 16 7.2 16 16V448c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V128c0-8.8 7.2-16 16-16H80zm88-32a24 24 0 1 1 48 0 24 24 0 1 1 -48 0zM289 267.6c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-89.7 89.7L129 287c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l53.3 53.3c4.5 4.5 10.6 7 17 7s12.5-2.5 17-7L289 267.6z"]},t.E9=t.DF},29658:function(e,t){t.DF={prefix:"far",iconName:"link",icon:[640,512,[128279,"chain"],"f0c1","M580.3 267.2c56.2-56.2 56.2-147.3 0-203.5C526.8 10.2 440.9 7.3 383.9 57.2l-6.1 5.4c-10 8.7-11 23.9-2.3 33.9s23.9 11 33.9 2.3l6.1-5.4c38-33.2 95.2-31.3 130.9 4.4c37.4 37.4 37.4 98.1 0 135.6L433.1 346.6c-37.4 37.4-98.2 37.4-135.6 0c-35.7-35.7-37.6-92.9-4.4-130.9l4.7-5.4c8.7-10 7.7-25.1-2.3-33.9s-25.1-7.7-33.9 2.3l-4.7 5.4c-49.8 57-46.9 142.9 6.6 196.4c56.2 56.2 147.3 56.2 203.5 0L580.3 267.2zM59.7 244.8C3.5 301 3.5 392.1 59.7 448.2c53.6 53.6 139.5 56.4 196.5 6.5l6.1-5.4c10-8.7 11-23.9 2.3-33.9s-23.9-11-33.9-2.3l-6.1 5.4c-38 33.2-95.2 31.3-130.9-4.4c-37.4-37.4-37.4-98.1 0-135.6L207 165.4c37.4-37.4 98.1-37.4 135.6 0c35.7 35.7 37.6 92.9 4.4 130.9l-5.4 6.1c-8.7 10-7.7 25.1 2.3 33.9s25.1 7.7 33.9-2.3l5.4-6.1c49.9-57 47-142.9-6.5-196.5c-56.2-56.2-147.3-56.2-203.5 0L59.7 244.8z"]},t.nN=t.DF},33542:function(e,t){t.DF={prefix:"far",iconName:"slash-forward",icon:[320,512,[],"2f","M308.1 3.3c11.4 6.7 15.3 21.4 8.6 32.8l-272 464c-6.7 11.4-21.4 15.3-32.8 8.6S-3.4 487.3 3.3 475.9l272-464C282 .4 296.7-3.4 308.1 3.3z"]},t.D2=t.DF},36:function(e,t,l){var n=l(56269);t.DF={prefix:n.prefix,iconName:n.iconName,icon:[n.width,n.height,n.aliases,n.unicode,n.svgPathData]},t.oD=t.DF,n.prefix,n.iconName,n.width,n.height,n.aliases,n.unicode,n.svgPathData,n.aliases},27736:function(e,t,l){l.d(t,{u:function(){return c},y:function(){return d}});var n=l(97458),i=l(15559),o=l.n(i),s=l(53840),r=l(8429),a=l(96449);let c=e=>{var t,l,i;let{initialResults:o}=e,c=null==o?void 0:o[0];if(!c)return(0,n.jsx)(n.Fragment,{});let m=(0,r.EH)(c);if(!m)return(0,n.jsx)(n.Fragment,{});let h=null!==(t=c.s3_social_preview_url)&&void 0!==t?t:a.FO,x="Perplexity AI";c.thread_title&&c.thread_title!==s.i?x=c.thread_title:c.query_str&&(x=c.query_str),x=(i=x).length<=80?i:i.slice(0,80).trim()+"...";let p=u(null!==(l=m.answer)&&void 0!==l?l:"Perplexity AI unlocks the power of knowledge with information discovery and sharing.");return(0,n.jsx)(d,{imageURL:h,title:x,description:p})},d=e=>{let{title:t,description:l,imageURL:i}=e;return(0,n.jsxs)(o(),{children:[(0,n.jsx)("meta",{property:"og:locale",content:"en_US"}),i&&(0,n.jsx)("meta",{property:"og:image",content:i}),(0,n.jsx)("meta",{property:"og:title",content:t}),(0,n.jsx)("meta",{property:"og:description",content:l}),(0,n.jsx)("meta",{property:"og:type",content:"website"}),(0,n.jsx)("meta",{property:"og:site_name",content:"Perplexity AI"}),(0,n.jsx)("meta",{name:"twitter:card",content:l?"summary_large_image":"summary"}),i&&(0,n.jsx)("meta",{name:"twitter:image",content:i}),(0,n.jsx)("meta",{name:"twitter:site",content:"@perplexity_ai"}),(0,n.jsx)("meta",{name:"twitter:title",content:t}),(0,n.jsx)("meta",{name:"twitter:description",content:l}),(0,n.jsx)("title",{children:t}),(0,n.jsx)("meta",{name:"description",content:l})]})},u=e=>{let t=e.split("|")[0].trim(),l=t.split("```")[0].trim();return l.length<e.length?"".concat(l,"..."):e}},69891:function(e,t,l){l.d(t,{j:function(){return eR}});var n=l(97458),i=l(87645),o=l(52983),s=l(59842),r=l(95914),a=l(44584),c=l(83397),d=l(78309),u=l(12150),m=l(36),h=l(94835),x=l(23647),p=l(66713);let v=o.memo(e=>{let{showStopButton:t,onStopButtonClick:l,...i}=e,{isMobileStyle:s}=(0,h.d)(),{currentOpenedModal:r}=(0,d.X)(),a=(0,o.useCallback)(e=>{"Escape"===e.key&&t&&l&&null===r&&(e.preventDefault(),l())},[l,t,r]);return(0,o.useEffect)(()=>(document.addEventListener("keydown",a),()=>{document.removeEventListener("keydown",a)}),[a]),(0,n.jsx)(x.ZP,{className:"w-full",children:(0,n.jsxs)(x.ZP,{className:" flex items-center gap-x-xs ",children:[t&&(0,n.jsx)("div",{children:(0,n.jsx)(p.Z,{toolTip:"Stop generating response",variant:"rejecter",pill:!0,icon:m.oD,keyboardShortcut:"Esc",onClick:l,isMobileStyle:s})}),(0,n.jsx)("div",{className:"grow",children:(0,n.jsx)(u.Z,{borderClass:"md:p-sm bg-offset dark:bg-offsetDark",hasShadow:!0,showFileUpload:!0,showCopilotToggle:!0,autofocus:null===r,querySource:i.submitWillFork?"fork":"followup",...i})})]})})});var f=l(28314),g=l(34810),j=l(19114),b=l(31210),w=l(27820),k=l(35254),y=l(8429),C=l(51899),_=l.n(C);let N=()=>{let[e,t]=(0,o.useState)(!1),[l,n]=(0,o.useState)(!1),{thread:i,lastResult:s,inFlight:r,inFlightLatest:a}=(0,w.a0)(),c=(0,k.f)(),d=(0,g.p)(),u=(0,o.useRef)(!0),m=(0,o.useMemo)(()=>!d&&(0,y.vl)(i),[i,d]),[h,x]=(0,o.useState)({}),p=(0,o.useCallback)(function(e){var t;let l=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=null===(t=h[e])||void 0===t?void 0:t.current;if(n){let e=n.getBoundingClientRect().top,t=e+window.scrollY-52;window.scrollTo({top:t,behavior:l?"smooth":"auto"})}},[h]),v=(0,o.useCallback)(()=>{p(i.length-1)},[p,i.length]),[f,j]=(0,o.useState)({}),b=(0,o.useCallback)(e=>{var t;let l=null===(t=f[e])||void 0===t?void 0:t.current;if(l){let e=l.getBoundingClientRect().top,t=e+window.scrollY-52;window.scrollTo({top:t,behavior:"auto"})}},[f]);return(0,o.useEffect)(()=>{x(e=>{let t={...e},l={...f},n=!1;return i.forEach((e,i)=>{let s=i.toString(),r=e.backend_uuid;if(t[s])l[r]=t[s];else{let e=o.createRef();t[s]=e,l[r]=e,n=!0}}),Object.keys(t).forEach(e=>{i.some((t,l)=>l.toString()===e)||(delete t[e],n=!0)}),n&&j(l),n?t:e})},[i.length]),(0,o.useEffect)(()=>{if(i.length<=1||!c)return;let e=window.location.hash;if(e&&!r&&u.current){try{let t=e.slice(1);if(t.length>3)b(t);else{let e=Number(t);p(e,!1)}}catch(e){console.error(e)}return}if(a){p(i.length-1);return}},[r,a,m,i.length,h,f,c,p,b]),(0,o.useEffect)(()=>{let o=_()(()=>{var o;let s=null===(o=h[i.length-1])||void 0===o?void 0:o.current;if(s){let i=s.getBoundingClientRect().top+window.scrollY-100,o=document.body.scrollHeight>window.innerHeight,r=window.innerHeight+window.scrollY>=document.body.scrollHeight-10;if(window.scrollY>=i||!o||r)e&&n(!0),t(!1);else{if(l)return;t(!0)}}},200);return o(),window.addEventListener("scroll",o),()=>{window.removeEventListener("scroll",o),o.cancel()}},[h,s,e,l,i.length]),{refs:h,scrollToLatestEntry:v,showScrollButton:e&&!l,hasScrolled:l,setHasScrolled:n}};var S=l(20618),M=l(33469),D=l(89292);function U(){let e=(0,a.useRouter)(),t=(0,k.f)(),l=t?window.location.origin:"https://www.perplexity.ai";return new URL("".concat(l).concat(e.asPath)).searchParams}var Z=l(81909),F=l(57881),I=l(63467),E=l(15068),R=l(50269),L=l(27736),P=l(27386),A=l(79612),T=l(36550),z=l(97381),O=l(78931),H=l(33131);let B={fork_count:0,like_count:0,view_count:0,user_likes:!1},q=()=>{let e=(0,S.nO)(),{firstResult:t}=(0,w.a0)(),l=(0,O.NL)(),{data:n}=(0,i.useSession)(),{openModal:s}=(0,d.X)(),r=(0,o.useCallback)(()=>{e&&(n?e.emit("toggle_thread_like",t.backend_uuid,e=>{l.setQueryData(["results",{frontend_context_uuid:t.frontend_context_uuid}],l=>{var n,i;if(!l)return;let[o,...s]=l;return[{...o,social_info:t.social_info?{...o.social_info,user_likes:null!==(n=null==e?void 0:e.user_likes)&&void 0!==n&&n,like_count:null!==(i=null==e?void 0:e.like_count)&&void 0!==i?i:0}:{...B}},...s]})}):s("loginModal",{origin:H.FM.THREAD_SOCIAL}))},[e,n,s,t.backend_uuid,t.frontend_context_uuid,t.social_info,l]);return{handleLikeClick:r}};var V=l(51253),W=l(49544),G=l(63820);let X=()=>{let{firstResult:e,socialStats:t}=(0,w.a0)(),{handleLikeClick:l}=q();if(!(null==e?void 0:e.backend_uuid))return(0,n.jsx)(n.Fragment,{});let i=t&&t.viewCount>0,o=t&&t.forkCount>0;return i||o?(0,n.jsxs)(x.ZP,{className:"flex items-center gap-x-sm ",children:[i&&(0,n.jsxs)(G.Z,{variant:"tiny",color:"light",className:"flex items-center gap-x-xs",children:[(0,n.jsx)(z.G,{size:"sm",fixedWidth:!0,icon:W.Md}),(0,n.jsx)("div",{children:(0,y.uf)(t.viewCount)})]}),o&&(0,n.jsxs)(G.Z,{variant:"tiny",color:"light",className:"flex items-center gap-x-xs",children:[(0,n.jsx)(z.G,{size:"sm",fixedWidth:!0,icon:V.MD}),(0,n.jsx)("div",{children:(0,y.uf)(t.forkCount)})]})]}):(0,n.jsx)(n.Fragment,{})};var Y=l(40531);let Q=o.memo(e=>{let{assistant:t,authorUsername:l,threadAccess:i,authorImage:o}=e,{isMobileStyle:s}=(0,h.d)(),{threadMetadata:r}=(0,w.a0)(),a=null===l||""===l;return(0,n.jsxs)("div",{className:"flex items-center gap-x-md",children:[(0,n.jsx)(x.ZP,{className:" rounded-full",children:(0,n.jsx)(A.Z,{anon:a,image:null!=o?o:void 0,username:null!=l?l:void 0,showAvatar:!0,showCreatorLabel:!1,showEdit:!1,isCurrentUser:!1})}),null!=t&&"internet"!==t&&(0,n.jsx)(x.ZP,{className:"rounded-full",children:(0,n.jsx)(T.Z,{textVariant:"smallBold",assistant:t})}),!a&&(null!=i?i:0)>=H.uv.PUBLIC_READ&&(0,n.jsx)(X,{}),(0,n.jsx)(Y.Z,{isMobileStyle:s,timestamp:r.updated_datetime,isRecentHidden:!0,layoutType:"bottom"})]})});var J=l(25967),K=l.n(J),$=l(14393),ee=l(99407);let et=e=>{let{currentCollection:t,size:l,handleCollectionChange:i,viewOnly:o}=e;if(o&&!t)return null;let s=(0,n.jsxs)(G.Z,{variant:"small"===l?"tiny":"smallBold",color:"light",className:"flex cursor-pointer select-none items-center gap-x-xs px-sm py-xs transition duration-300 hover:opacity-70",children:[(0,n.jsx)("div",{children:(0,n.jsx)(z.G,{icon:ee.r8})}),(0,n.jsx)("div",{children:"Collection"})]});return(0,n.jsx)("div",{children:t?t?(0,n.jsx)(K(),{href:"/collections/".concat(t.slug),children:(0,n.jsxs)(G.Z,{variant:"small"===l?"tiny":"smallBold",className:"flex cursor-pointer select-none items-center gap-x-xs px-sm py-xs transition duration-300 hover:opacity-70",children:[(0,n.jsx)($.B,{unified:t.emoji,size:"tiny"}),(0,n.jsx)("span",{className:"overflow-hidden truncate text-ellipsis",children:t.title})]})}):null:(0,n.jsx)("div",{onClick:o?void 0:i,children:s})})};var el=l(22660),en=l(51582),ei=l(80932),eo=l(54911),es=l(34461),er=l(14808),ea=l(67883),ec=l(79081),ed=l(99094),eu=l(24581),em=l(61242),eh=l(21382),ex=l(96449),ep=l(68575);let ev=o.memo(e=>{var t,l;let{descriptionText:i,sharableURL:s,rwToken:a,frontendContextUUID:c}=e,{openModal:u}=(0,d.X)(),m=(0,ed.O)(),h=(0,k.f)(),x=(0,F.lG)(),{threadMetadata:p}=(0,w.a0)(),v=p.contextUUID,f=p.collection,g=null==f?void 0:f.access,j=p.thread_access,b=(0,O.NL)(),[y,C]=(0,o.useState)(null!==(l=null!=g?g:j)&&void 0!==l?l:ex.k6),_=(0,r.useTranslations)("search.thread"),N=e=>{e!==y&&(x?null!=v&&null!=a&&m(v,e,a,e=>{C(e),b.setQueryData(["results",{frontend_context_uuid:c}],t=>{if(!t)return;let[l,...n]=t;return[{...l,thread_access:e},...n]})}):u("loginModal",{pitchMessage:{title:_("shareLogin",{threads:"Threads"}),description:_("shareDescription",{threads:"Threads",collections:"Collections"})},origin:H.FM.SHARE_DROPDOWN}))},S=(0,eh.o)({currentAccessLevel:y,onClick:N,isCollection:!1}),M=S[y],D=y>H.uv.PRIVATE_READ;(0,o.useEffect)(()=>{var e;C(null!==(e=null!=g?g:j)&&void 0!==e?e:ex.k6)},[g,j]);let U=(0,n.jsxs)("div",{className:"p-sm",children:[null!=f?(0,n.jsxs)("div",{className:"",children:[(0,n.jsxs)(G.Z,{variant:"smallBold",className:"pb-sm",children:["View Access set to"," ",null===(t=S[null==f?void 0:f.access])||void 0===t?void 0:t.text," by:"]}),(0,n.jsx)(eu.n,{selected:!1,selectCollection:()=>null,collection:f})]}):null!=a?(0,n.jsxs)("div",{className:"",children:[(0,n.jsx)(G.Z,{variant:"baseSemi",className:"",children:"View Access"}),(0,n.jsx)(ep.Z,{choices:S})]}):null,(0,n.jsx)(ec.Z,{descriptionText:i,shareHref:s,isSharable:D,hasMounted:h,icon:null==M?void 0:M.icon})]});return(0,n.jsx)(em.Z,{isSharable:D,hasMounted:h,shareHref:s,EditorDropDownContent:U,icon:null==M?void 0:M.icon,onClick:()=>N(H.uv.PUBLIC_READ)})});var ef=l(51865),eg=l.n(ef);let ej=o.memo(e=>{let{visible:t,rwToken:l,tweetDescriptionText:i,entryUUID:s,threadSharedSlug:r,frontendContextUUID:a}=e,c=(0,k.f)(),[d,u]=(0,o.useState)("");(0,o.useEffect)(()=>{let{protocol:e,host:t}=window.location;u("".concat(e,"//").concat(t,"/search/").concat(r))},[r]);let m=(0,o.useMemo)(()=>encodeURIComponent(c?(0,y.RP)(decodeURIComponent(d)):""),[d,c]),h=(0,o.useMemo)(()=>null!=i?"Perplexity AI: ".concat(i):"Perplexity AI",[i]),x=(0,o.useMemo)(()=>eg()("transition-all duration-300 opacity flex items-center gap-x-xs md:gap-x-0",{"opacity-0":!t,"opacity-100":t}),[t]);return(0,n.jsx)("div",{className:x,children:t&&(0,n.jsx)(ev,{descriptionText:h,entryUUID:s,sharableURL:m,rwToken:l,frontendContextUUID:a})})});var eb=l(53840),ew=l(80937),ek=l(33542),ey=l(25454);let eC=o.memo(e=>{var t,l,i,s,c;let{entryUUID:u,frontendContextUUID:m,collection:v}=e,f=(0,a.useRouter)(),b=(0,k.f)(),y=(0,F.lG)(),{collections:C}=(0,eo.l)(),_=(0,g.p)(),{searchTerm:N}=(0,ea.p)(),S=(0,ei.J)(),{deleteThread:M}=(0,es.l)(),{openModal:D,closeModal:U}=(0,d.X)(),{refetch:Z,addItemToSidebar:I}=(0,er.f)(),{removeThreadFromCollection:E}=(0,es.l)(),{isMobileStyle:R}=(0,h.d)(),{isLoading:L,threadMetadata:P}=(0,w.a0)(),{trackEvent:A}=(0,j.WS)(),T=(0,r.useTranslations)("search.thread");(0,o.useEffect)(()=>{let e=P.title||P.first_query,t=P.thread_url_slug;if(_&&b&&e&&t){let l="/search/".concat(t,"?newFrontendContextUUID=").concat(m);I({id:u,variant:"thread",title:e,permalink:l}),Z()}},[P,_,b,m,u,I,Z]);let O=(0,o.useCallback)(()=>{A("click back button",{})},[A]),B=(0,o.useCallback)(()=>{A("click logo",{})},[A]),q=(0,o.useCallback)(()=>{u&&(A("delete thread from search result page click",{entryUUID:u}),M({entryUUID:u,callback:()=>f.push("/")}))},[M,u,f,A]),V=(0,o.useCallback)(()=>{if(y){if(0===C.length)S.listUserCollections(e=>{if(0===e.length)D("collectionCreateOrEdit",{existingCollection:null,searchTerm:N});else{var t;D("collectionSelectModal",{entryUUID:u,userCollections:e,currentCollection:v,searchTerm:null!==(t=P.first_query)&&void 0!==t?t:"",frontendContextUUID:m})}});else{var e;D("collectionSelectModal",{entryUUID:u,userCollections:C,currentCollection:v,searchTerm:null!==(e=P.first_query)&&void 0!==e?e:"",frontendContextUUID:m})}}else D("loginModal",{pitchMessage:{title:T("headerLogin",{threads:"Threads"})},origin:H.FM.COLLECTIONS})},[v,S,u,m,y,D,N,T,P.first_query,C]),W=()=>{let e=null==v?void 0:v.uuid;E({entryUUID:u,oldCollectionUUID:e,callback:U,frontendContextUUID:m})},X=!!_&&y||null!=v,Y=!!_&&y||P.title!=eb.i&&null!=P.title;return(0,n.jsx)(x.ZP,{variant:"background",className:"sticky left-0 right-0 top-0 z-20 border-b md:mb-0 md:rounded-t-xl",children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-x-md px-md py-sm md:min-h-[53px]",children:[(0,n.jsx)("div",{className:"hidden md:block",children:!L&&(0,n.jsx)(Q,{assistant:null!==(t=P.assistant)&&void 0!==t?t:null,authorUsername:null!==(l=P.author_username)&&void 0!==l?l:null,threadAccess:null!==(i=P.thread_access)&&void 0!==i?i:0,authorImage:null!==(s=P.author_image)&&void 0!==s?s:null})}),(0,n.jsxs)("div",{className:"flex items-center gap-x-sm md:hidden",children:[(0,n.jsx)(K(),{href:"/",onClick:B,children:(0,n.jsx)(ey.Z,{size:"small",variant:"mark"})}),(0,n.jsx)(p.Z,{isMobileStyle:R,variant:"common",size:"small",text:"New",icon:ew.r8,href:"/",onClick:O})]}),(0,n.jsxs)("div",{className:"hidden max-w-md grow items-center justify-center gap-x-xs text-center md:flex",children:[X&&(0,n.jsx)(et,{currentCollection:v,handleCollectionChange:V,viewOnly:!y||!_}),X&&Y&&(0,n.jsx)(G.Z,{variant:"smallBold",color:"light",children:(0,n.jsx)(z.G,{icon:ek.D2})}),Y&&(0,n.jsx)(eb.Z,{title:P.title,contextUUID:P.contextUUID,rwToken:_,frontendContextUUID:m})]}),(0,n.jsxs)("div",{className:"flex items-center gap-x-sm",children:[(0,n.jsx)(el.Z,{show:b&&!!_,onDelete:q,onAddToCollection:V,onSwapCollection:V,onRemoveFromCollection:W,currentCollection:v,rwToken:_,type:en.W.LIBRARY}),(0,n.jsx)(ej,{visible:!!P.thread_url_slug,rwToken:_,tweetDescriptionText:P.title||P.first_query,entryUUID:u,frontendContextUUID:m,threadSharedSlug:null!==(c=P.thread_url_slug)&&void 0!==c?c:void 0})]})]})})}),e_=e=>{let{parentInfo:t}=e;return(0,n.jsx)(K(),{href:"/search/".concat(t.thread_url_slug),children:(0,n.jsx)(x.ZP,{variant:"offset",bgHover:"offsetPlus",className:"flex justify-between rounded-lg p-md md:mt-md",children:(0,n.jsxs)("div",{className:"",children:[(0,n.jsxs)(G.Z,{color:"light",variant:"tiny",className:"mb-xs flex items-center gap-x-xs",children:[(0,n.jsx)(z.G,{icon:V.MD}),(0,n.jsx)("div",{children:"Follow up to"})]}),(0,n.jsx)(G.Z,{variant:"section-title",color:"light",className:"line-clamp-1 break-all",children:t.query_str})]})})})};var eN=l(85002),eS=l(52167);let eM=e=>{try{return JSON.parse(e)}catch(e){return null}},eD="Please try again later.",eU=o.memo(e=>{let{title:t="Sorry, something went wrong.",description:l=eD}=e,i=(0,o.useMemo)(()=>eM(l),[l]);return i&&(l=eD,console.warn("Tried to pass a JSON error description"),console.warn(i)),(0,n.jsxs)("div",{className:"bg-orange-100 border-l-4 border-orange-500 text-orange-700 p-4 text-left mt-4 rounded-lg",role:"alert",children:[(0,n.jsx)("p",{className:"font-bold",children:t}),(0,n.jsx)("p",{children:l})]})});var eZ=l(69942),eF=l(24551),eI=l(77837),eE=l.n(eI);let eR=()=>{var e,t,l,d,u,m,k,C;let{data:_}=(0,i.useSession)(),A=(0,F.lG)(),T=(0,S.nO)(),{isMobileStyle:z}=(0,h.d)(!0),O=(0,g.p)(),{feedbackButtonEnabled:H}=(0,E.X)(),B=(0,eS.X)(),q=U(),[V,{left:W,width:G}]=(0,s.Z)(),X=q.get("q"),{trackEvent:Y}=(0,j.WS)(),J=(0,a.useRouter)(),{thread:K,isLoading:$,inFlight:ee,lastResult:et,threadMetadata:el}=(0,w.a0)(),en=null===(e=K[0])||void 0===e?void 0:e.frontend_context_uuid,ei=(0,r.useTranslations)("askInput"),{submitQuery:eo,handleBotStep:es,deleteLastResult:er}=(0,M.e)(),{setAssistant:ea,assistant:ec,setIsCopilot:ed,gpt4Limit:eu,isCopilot:em}=(0,D.h)();(0,o.useEffect)(()=>{var e,t;let l=null!==(t=null===(e=K[0])||void 0===e?void 0:e.search_focus)&&void 0!==t?t:"internet";ea(l);let n=K.some(e=>"copilot"===e.mode)&&!!eu&&eu>0;ed(n)},[]),(0,o.useEffect)(()=>{var e;ea(null!==(e=el.assistant)&&void 0!==e?e:ec)},[el.assistant]);let eh=(0,o.useMemo)(()=>!O&&(0,y.vl)(K),[K,O]),ex=0===K.length||ee,ep=null==et?void 0:et.backend_uuid,ev=(0,o.useCallback)(e=>{let t=(0,y.Mp)();eo({fork:eh,rawQuery:e.query,copilotOverride:!!A&&void 0,attachments:e.attachments,collection:null,newFrontendContextUUID:eh?t:null,existingFrontendContextUUID:eh?null:en,promptSource:"user",querySource:"followup"}),eh&&J.push("/search?q=pending&newFrontendContextUUID=".concat(t),"/search?",{shallow:!0})},[eh,eo,A,en,J]),{setUserInput:ef,...ej}=(0,b.l)({clearInputOnSubmit:!0,onSubmit:eE()(ev,1e3,{leading:!0})}),eb=(0,o.useCallback)(e=>{eo(e)},[eo]),ew=(0,o.useMemo)(()=>{var e;return 0===K.length||K.length>0&&(null===(e=K[0])||void 0===e||!e.backend_uuid)},[K]);!function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=U(),l=t.get("q"),n=t.get("copilot"),i=t.get("focus"),s=(0,F.lG)(),r=(0,S.nO)(),c=(0,a.useRouter)(),{setAssistant:d,setIsCopilot:u}=(0,D.h)(),{hasLoadedSettings:m,gpt4Limit:h}=(0,Z.v)(),{submitQuery:x}=(0,M.e)();(0,o.useEffect)(()=>{if(s&&!m||!e||!l)return;let t=i&&i in I.w?i:void 0;void 0!==t&&d(t);let o="true"===n&&h>0;u(o);let r=(0,y.Mp)();x({rawQuery:Array.isArray(l)?l[0]:l,assistantOverride:t,copilotOverride:o,collection:null,newFrontendContextUUID:r,existingFrontendContextUUID:null,promptSource:"user",querySource:"default_search"}),c.push("/search?q=pending&newFrontendContextUUID=".concat(r),"/search",{shallow:!0})},[m,r])}(ew);let{refs:ek,scrollToLatestEntry:ey,showScrollButton:eM,hasScrolled:eD,setHasScrolled:eI}=N();(0,o.useEffect)(()=>{""!=X&&ef("")},[X,ef]);let eR=(0,o.useMemo)(()=>{try{if(!et)throw Error("lastResult is null");let e=(0,y.cW)(et);return null!=e&&"FINAL"!==e[e.length-1].step_type}catch(e){return!1}},[et]),eL=(0,o.useMemo)(()=>K&&(null==et?void 0:et.status)!=="completed"&&(null==et?void 0:et.backend_uuid)!==void 0&&ee,[K,null==et?void 0:et.status,null==et?void 0:et.backend_uuid,ee]),eP=(0,o.useCallback)(()=>{null==T||T.emit("perplexity_terminate",{entry_uuid:ep})},[ep,T]);return(0,o.useEffect)(()=>{(null==K?void 0:K.length)>=1&&(null==et?void 0:et.status)==="completed"&&Y("thread viewed",{authorId:el.author_id,authorUsername:el.author_username,isThreadCreator:!!O})},[Y]),(0,n.jsxs)(c.Z,{mobileDefaultHeader:!1,showFooter:!1,childrenWidth:"lg",header:(0,n.jsx)(eC,{collection:null!==(l=el.collection)&&void 0!==l?l:null,entryUUID:null!==(d=null===(t=K[0])||void 0===t?void 0:t.backend_uuid)&&void 0!==d?d:null,frontendContextUUID:en}),children:[!0===$?(0,n.jsx)("h1",{children:"Loading"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(L.u,{initialResults:K}),(0,n.jsx)("div",{className:"pb-[124px] pt-md md:pt-0",children:(0,n.jsxs)(x.ZP,{variant:"background",className:"relative",children:[el.parent_info&&(0,n.jsx)(e_,{parentInfo:el.parent_info}),(0,n.jsx)("div",{className:"my-md md:hidden",children:(0,n.jsx)(Q,{assistant:null!==(u=el.assistant)&&void 0!==u?u:null,authorUsername:null!==(m=el.author_username)&&void 0!==m?m:void 0,threadAccess:null!==(k=el.thread_access)&&void 0!==k?k:0,authorImage:null!==(C=el.author_image)&&void 0!==C?C:null})}),(0,n.jsx)("div",{ref:V,children:K.map((e,t)=>{var l,i,s;let r=t===K.length-1;return(0,n.jsx)(o.Fragment,{children:(0,n.jsx)(f.Z,{fallback:(0,n.jsx)(eU,{description:null!==(l=null==e?void 0:e.text)&&void 0!==l?l:"Please try again later."}),children:(0,n.jsx)(P.Z,{inFlight:ee,isReadonly:eh,showAnimations:ex&&r,result:e,submit:eo,onRelatedButtonClick:eb,isLastResult:r,isFirstResult:0===t,deleteLast:r&&1!==K.length?()=>{var e;return er({frontendContextUUID:null===(e=K[0])||void 0===e?void 0:e.frontend_context_uuid})}:void 0,onBotStep:t=>es(e,t),showSurvey:H||!!B,idx:t,ref:ek[t]})})},null!==(s=null!==(i=null==e?void 0:e.uuid)&&void 0!==i?i:null==e?void 0:e.backend_uuid)&&void 0!==s?s:t)})}),(0,n.jsx)("div",{className:"mb-xl"}),W>0&&(0,n.jsx)(x.ZP,{style:{left:z?"0px":"".concat(W,"px"),width:z?"100%":"".concat(G,"px")},className:eg()("pointer-events-none fixed z-10 grid-cols-12 gap-xl px-sm py-sm md:bottom-lg md:grid md:px-0",{"!hidden":eR,"bottom-[64px]":_,"bottom-0":!_}),children:(0,n.jsxs)("div",{className:"pointer-events-auto md:col-span-8",children:[(0,n.jsx)(eZ.M,{initial:!1,children:eM&&!eD&&K.length>1&&(0,n.jsx)(eF.E.div,{className:"mb-2 flex justify-center",initial:{opacity:0,y:5},animate:{opacity:1,y:0,transition:{delay:1,duration:.15,ease:"easeOut"}},exit:{opacity:0,transition:{duration:.1,ease:"easeOut"}},children:(0,n.jsx)("div",{className:"inline-flex rounded-full bg-offset shadow-md dark:bg-offsetDark",children:(0,n.jsx)(p.Z,{isMobileStyle:z,size:"small",variant:"common",icon:eN.r5,layout:"center",pill:!0,onClick:()=>{ey(),eI(!0)},toolTip:"Scroll to bottom"})})})}),(0,n.jsx)(v,{...ej,isFollowUp:!0,disabled:ee,placeholder:z&&ee?"":ei("placeholderFollowUp"),submitWillFork:eh,showStopButton:eL,onStopButtonClick:eP})]})})]})})]}),(0,n.jsx)("div",{className:"md:hidden",children:(0,n.jsx)(R.Z,{havePrimaryButton:!1})})]})}},61242:function(e,t,l){l.d(t,{Z:function(){return h}});var n=l(97458),i=l(52983),o=l(32576),s=l(29658),r=l(94835),a=l(8429),c=l(66713);let d=e=>{let{shareHref:t,hasMounted:l,isSharable:d}=e,{trackEvent:u}=(0,o.h)(),{isMobileStyle:m}=(0,r.d)(),h=(0,i.useCallback)(()=>{navigator.clipboard.writeText(l?(0,a.RP)(decodeURIComponent(t)):""),u("click copy link button",{})},[t,l,u]);return d?(0,n.jsx)(c.Z,{isMobileStyle:m,clickFeedback:!0,size:"small",variant:"primary",onClick:h,toolTip:"Copy Link",tooltipLayout:"bottom",icon:s.nN}):null};var u=l(51800);let m=e=>{let{isSharable:t,hasMounted:l,shareHref:i,EditorDropDownContent:o,icon:s,onClick:a}=e,{isMobileStyle:m}=(0,r.d)();return l?(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"flex items-center gap-x-sm",children:[(0,n.jsx)(d,{shareHref:i,hasMounted:l,isSharable:t}),(0,n.jsx)(u.p,{content:o,placement:"bottom-end",isMobileStyle:m,children:(0,n.jsx)(c.Z,{isMobileStyle:m,onClick:a,variant:"primary",size:"small",text:"Share",icon:s})})]})}):null};var h=m},79081:function(e,t,l){var n=l(97458),i=l(97381),o=l(52983),s=l(95914),r=l(32576),a=l(57632),c=l(91007),d=l(75421),u=l(44835),m=l(29658),h=l(94835),x=l(8429),p=l(63820),v=l(66713);let f=e=>{let{descriptionText:t,shareHref:l,isSharable:f,hasMounted:g,icon:j}=e,b=encodeURIComponent(t),{trackEvent:w}=(0,r.h)(),{isMobileStyle:k}=(0,h.d)(),y=(0,s.useTranslations)("socialShare"),C=(0,o.useMemo)(()=>"https://twitter.com/intent/tweet?text=".concat(b,"&url=").concat(l),[b,l]),_=(0,o.useMemo)(()=>"https://api.whatsapp.com/send?text=".concat(b,"%20").concat(l),[b,l]),N=(0,o.useMemo)(()=>"https://www.facebook.com/sharer/sharer.php?u=".concat(l,"&quote=").concat(b),[b,l]),S=(0,o.useCallback)(()=>{navigator.clipboard.writeText(g?(0,x.RP)(decodeURIComponent(l)):""),w("click copy link button",{})},[l,g,w]),M=(0,o.useCallback)(()=>{if(!(null==navigator?void 0:navigator.share)){window.open(C,"_blank");return}navigator.share({text:"".concat(t," ").concat(g?(0,x.RP)(decodeURIComponent(l)):""),title:"Perplexity AI"}),w("click mobile native share button",{})},[l,C,t,g,w]),D=[{text:"Twitter",icon:d.NC,target:"_blank",href:C,onClick:()=>w("click tweet button",{})},{text:y("copyLink"),clickFeedback:!0,icon:m.nN,onClick:S},{text:"WhatsApp",icon:c.VH,target:"_blank",href:_,onClick:()=>w("click whatsapp button",{})},{text:"Facebook",icon:a.ne,target:"_blank",href:N,onClick:()=>w("click facebook button",{})}];return((0,o.useEffect)(()=>{g&&f&&S()},[g,f,S]),g&&f)?(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"mt-sm",children:(0,n.jsxs)(p.Z,{variant:"tiny",color:"super",children:[(0,n.jsx)(i.G,{icon:u.E9,className:"mr-xs"}),(0,n.jsx)("span",{children:y("linkCopied")})]})}),(0,n.jsxs)("div",{className:"hidden md:block",children:[(0,n.jsx)(p.Z,{variant:"baseSemi",className:"mb-sm mt-md",children:"Share"}),(0,n.jsx)("div",{className:"grid grid-cols-2 gap-xs",children:D.map(e=>(0,n.jsx)("div",{children:(0,n.jsx)(v.Z,{layout:"left",size:"small",fullWidth:!0,...e,isMobileStyle:k})},e.text))})]}),(0,n.jsx)("div",{className:"block md:hidden",children:(0,n.jsx)("div",{className:"mt-md",children:(0,n.jsx)(v.Z,{variant:"primary",fullWidth:!0,text:y("share"),target:"_blank",icon:j,onClick:M,isMobileStyle:k})})})]}):null};t.Z=f},50269:function(e,t,l){var n=l(97458),i=l(87645);l(52983);var o=l(78309),s=l(65114),r=l(94112),a=l(89650),c=l(7321),d=l(94835),u=l(66713),m=l(96449),h=l(33131);let x=e=>{let{}=e,{openModal:t}=(0,o.X)(),{data:l}=(0,i.useSession)(),{isAndroid:x,isIOS:p}=(0,c.Fy)(),{isMobileStyle:v}=(0,d.d)();return l?null:(0,n.jsxs)("div",{className:"flex items-center gap-x-sm pb-md pt-sm",children:[p&&(0,n.jsx)(u.Z,{fullWidth:!0,isMobileStyle:v,text:"Get iPhone App",variant:"common",size:"small",href:m.Fv,icon:r.Av}),x&&(0,n.jsx)(u.Z,{fullWidth:!0,isMobileStyle:v,text:"Get Android App",variant:"common",size:"small",href:m.Wn,icon:s.us}),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(u.Z,{isMobileStyle:v,size:"small",variant:"common",fullWidth:!0,icon:a.BE,text:"Sign In",onClick:()=>t("loginModal",{origin:h.FM.MOBILE_SIGNUP})})})]})};t.Z=x},68575:function(e,t,l){var n=l(97458);l(52983);var i=l(23647),o=l(96416);let s=e=>{let{choices:t}=e;return(0,n.jsx)(i.ZP,{className:"rounded md:border divide-y mt-sm ",children:t.map((e,t)=>(0,n.jsx)(o.s,{rounded:!1,...e},t))})};t.Z=s}}]);